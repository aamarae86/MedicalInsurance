@using ERP.Web.UI.Controllers.CRM
@using ERP.ResourcePack.CRM.activityTask
@using ERP.Web.UI.Models.ViewModels.CRM.ActivityTasks
@{
    ViewBag.Title = ERP.ResourcePack.CRM.activityTask.activityTask.Title;
    Layout = "~/Views/Shared/_Layout.cshtml";
    string formTrigger = ViewBag.trigger;
    long? id = ViewData["Id"] == null ? null : (long?)Convert.ToInt32(ViewData["Id"]);
    var detailObj = ViewData["DetailAsync"] == null ? null : ViewData["DetailAsync"] as ActivityTasksVM;

    detailObj = detailObj ?? new ActivityTasksVM
    {
        CrmLeadsPersonsId = ViewBag.LeadId,
        CrmLeadsPersonsVal = ViewBag.Leadname,
        RelatedToLkpId = ViewBag.RelLkpId,
        RelatedToLkpVal = ViewBag.RelLkpVal
    };
}


<div class="row clearfix">
    <div class="col-12">


        <div class="row no-gutters clearfix">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="card">
                    <div class="header d-flex justify-content-start align-items-center">
                        <i class="fas fa-2x fa-chevron-down down-arr mr-2" data-toggle="collapse" data-target="#dataCollapse1"></i>
                        <h2> <strong>@activityTask.Title</strong>  </h2>



                    </div>
                    <div class="body collapse show" id="dataCollapse1">


                        @Html.Action(nameof(ActivityTasksController.ActivityTasksForm), new { id = id, trigger = formTrigger, ActivityTasksVM = detailObj })




                    </div>
                </div>
            </div>
        </div>




    </div>
    <div class="row clearfix">
        <div class="col-md-12 text-center" id="btnPostOrRefuseTenantContainer"></div>
    </div>


</div>

@Html.Action(nameof(ERP.Web.UI.Controllers.CRM.ActivityTasksController.ActivityTasksData))



<div class="card-body">
    <div class="text-center">

        @if (detailObj.RelatedToLkpId == 11119)
        {
            <a href="~/CrmLeadsPersons" class="btn btn-danger btn-lg m-l-15 waves-effect">@(ERP.ResourcePack.Common.Settings.BtnClose)</a>

        }
        else if (detailObj.RelatedToLkpId == 11121)
        {
            <a href="~/CrmContact" class="btn btn-danger btn-lg m-l-15 waves-effect">@(ERP.ResourcePack.Common.Settings.BtnClose)</a>

        }
        else
        {
            <a href="~/CrmQueries" class="btn btn-danger btn-lg m-l-15 waves-effect">@(ERP.ResourcePack.Common.Settings.BtnClose)</a>
        }
    </div>
</div>




 


@section scripts{
    <script>
        const primaryEntityKeyId =  @(id ?? 0);
        const trigger = '@formTrigger';
    </script>
    <script src="~/Scripts/jquery.validate.min.js"></script>
    <script src="~/Scripts/jquery.validate.unobtrusive.min.js"></script>

    @Html.Partial("~/ViewsScripts/_CRM/ActivityTasksScripts.cshtml")


}   